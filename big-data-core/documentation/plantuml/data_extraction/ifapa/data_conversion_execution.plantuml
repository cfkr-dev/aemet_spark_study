@startuml
actor User

participant "IfapaToAemetConverter" as IFAPA_TO_AEMET_CONVERTER
participant "SingleStationInfo" as SINGLE_STATION_INFO
participant "SingleStationMeteoInfo" as SINGLE_STATION_METEO_INFO
participant "FileUtils" as FILE_UTILS
participant "JSONUtils" as JSON_UTILS

User -> IFAPA_TO_AEMET_CONVERTER : ifapaToAemetConversion()
activate IFAPA_TO_AEMET_CONVERTER

'--- Convert Station Info ---
IFAPA_TO_AEMET_CONVERTER -> SINGLE_STATION_INFO : saveSingleStationInfoAemetFormat()
activate SINGLE_STATION_INFO
SINGLE_STATION_INFO -> JSON_UTILS : readJSON(ifapa station info)
JSON_UTILS --> SINGLE_STATION_INFO : JSON response
SINGLE_STATION_INFO -> JSON_UTILS : readJSON(aemet metadata)
JSON_UTILS --> SINGLE_STATION_INFO : metadata JSON
SINGLE_STATION_INFO -> JSON_UTILS : buildJSONFromSchemaAndData()
JSON_UTILS --> SINGLE_STATION_INFO : structured JSON
SINGLE_STATION_INFO -> JSON_UTILS : transformJSONValues(formatters)
JSON_UTILS --> SINGLE_STATION_INFO : transformed JSON
SINGLE_STATION_INFO -> FILE_UTILS : saveContentToPath(data)
FILE_UTILS --> SINGLE_STATION_INFO : success
SINGLE_STATION_INFO -> FILE_UTILS : copyFile(metadata)
FILE_UTILS --> SINGLE_STATION_INFO : success
SINGLE_STATION_INFO --> IFAPA_TO_AEMET_CONVERTER : done
deactivate SINGLE_STATION_INFO

'--- Convert Meteo Info ---
IFAPA_TO_AEMET_CONVERTER -> SINGLE_STATION_METEO_INFO : saveSingleStationMeteoInfoAemetFormat()
activate SINGLE_STATION_METEO_INFO
SINGLE_STATION_METEO_INFO -> JSON_UTILS : readJSON(ifapa meteo info)
JSON_UTILS --> SINGLE_STATION_METEO_INFO : JSON response
SINGLE_STATION_METEO_INFO -> JSON_UTILS : readJSON(station info)
JSON_UTILS --> SINGLE_STATION_METEO_INFO : JSON response
SINGLE_STATION_METEO_INFO -> JSON_UTILS : readJSON(aemet metadata)
JSON_UTILS --> SINGLE_STATION_METEO_INFO : metadata JSON
SINGLE_STATION_METEO_INFO -> JSON_UTILS : buildJSONFromSchemaAndData()
JSON_UTILS --> SINGLE_STATION_METEO_INFO : structured JSON
SINGLE_STATION_METEO_INFO -> JSON_UTILS : transformJSONValues(formatters)
JSON_UTILS --> SINGLE_STATION_METEO_INFO : transformed JSON
SINGLE_STATION_METEO_INFO -> FILE_UTILS : saveContentToPath(data)
FILE_UTILS --> SINGLE_STATION_METEO_INFO : success
SINGLE_STATION_METEO_INFO -> FILE_UTILS : copyFile(metadata)
FILE_UTILS --> SINGLE_STATION_METEO_INFO : success
SINGLE_STATION_METEO_INFO --> IFAPA_TO_AEMET_CONVERTER : done
deactivate SINGLE_STATION_METEO_INFO

IFAPA_TO_AEMET_CONVERTER --> User : finished
deactivate IFAPA_TO_AEMET_CONVERTER
@enduml
