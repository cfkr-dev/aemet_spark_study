include "../url/global.conf"
include "../storage/single-param-studies.conf"
include "../utils.conf"
include "../../global/schema/spark.conf"

study-params-values = [
  {
    study-param-name = "temperature",
    study-param-abbrev = "temp",
    study-param-unit = "ºC",
    col-agg-method = ${group-methods.avg}
  },
  {
    study-param-name = "precipitation",
    study-param-abbrev = "prec",
    study-param-unit = "mm",
    col-agg-method = ${group-methods.sum}
  },
  {
    study-param-name = "wind velocity",
    study-param-abbrev = "wind_vel",
    study-param-unit = "m/s",
    col-agg-method = ${group-methods.avg}
  },
  {
    study-param-name = "pressure",
    study-param-abbrev = "press",
    study-param-unit = "hPa",
    col-agg-method = ${group-methods.avg}
  },
  {
    study-param-name = "sun radiation",
    study-param-abbrev = "sun_rad",
    study-param-unit = "h",
    col-agg-method = ${group-methods.avg}
  },
  {
    study-param-name = "relative humidity",
    study-param-abbrev = "rel_hum",
    study-param-unit = "%",
    col-agg-method = ${group-methods.avg}
  },
]

state-values = [
  {
    state-name = "A CORUÑA",
    state-name-no-sc = "a_coruna"
  },
  {
    state-name = "ALBACETE",
    state-name-no-sc = "albacete",
  },
  {
    state-name = "ALICANTE",
    state-name-no-sc = "alicante"
  },
  {
    state-name = "ALMERIA",
    state-name-no-sc = "almeria"
  },
  {
    state-name = "ARABA/ALAVA",
    state-name-no-sc = "araba"
  },
  {
    state-name = "ASTURIAS",
    state-name-no-sc = "asturias"
  },
  {
    state-name = "AVILA",
    state-name-no-sc = "avila"
  },
  {
    state-name = "BADAJOZ",
    state-name-no-sc = "badajoz"
  },
  {
    state-name = "BARCELONA",
    state-name-no-sc = "barcelona"
  },
  {
    state-name = "BIZKAIA",
    state-name-no-sc = "bizkaia"
  },
  {
    state-name = "BURGOS",
    state-name-no-sc = "burgos"
  },
  {
    state-name = "CACERES",
    state-name-no-sc = "caceres"
  },
  {
    state-name = "CADIZ",
    state-name-no-sc = "cadiz"
  },
  {
    state-name = "CANTABRIA",
    state-name-no-sc = "cantabria"
  },
  {
    state-name = "CASTELLON",
    state-name-no-sc = "castellon"
  },
  {
    state-name = "CEUTA",
    state-name-no-sc = "ceuta"
  },
  {
    state-name = "CIUDAD REAL",
    state-name-no-sc = "cuidad_real"
  },
  {
    state-name = "CORDOBA",
    state-name-no-sc = "cordoba"
  },
  {
    state-name = "CUENCA",
    state-name-no-sc = "cuenca"
  },
  {
    state-name = "GIPUZKOA",
    state-name-no-sc = "gipuzkoa"
  },
  {
    state-name = "GIRONA",
    state-name-no-sc = "girona"
  },
  {
    state-name = "GRANADA",
    state-name-no-sc = "granada"
  },
  {
    state-name = "GUADALAJARA",
    state-name-no-sc = "guadalajara"
  },
  {
    state-name = "HUELVA",
    state-name-no-sc = "huelva"
  },
  {
    state-name = "HUESCA",
    state-name-no-sc = "huesca"
  },
  {
    state-name = "ILLES BALEARS",
    state-name-no-sc = "illes_balears"
  },
  {
    state-name = "JAEN",
    state-name-no-sc = "jaen"
  },
  {
    state-name = "LA RIOJA",
    state-name-no-sc = "la_rioja"
  },
  {
    state-name = "LAS PALMAS",
    state-name-no-sc = "las_palmas"
  },
  {
    state-name = "LEON",
    state-name-no-sc = "leon"
  },
  {
    state-name = "LLEIDA",
    state-name-no-sc = "lleida"
  },
  {
    state-name = "LUGO",
    state-name-no-sc = "lugo"
  },
  {
    state-name = "MADRID",
    state-name-no-sc = "madrid"
  },
  {
    state-name = "MALAGA",
    state-name-no-sc = "malaga"
  },
  {
    state-name = "MELILLA",
    state-name-no-sc = "melilla"
  },
  {
    state-name = "MURCIA",
    state-name-no-sc = "murcia"
  },
  {
    state-name = "NAVARRA",
    state-name-no-sc = "navarra"
  },
  {
    state-name = "OURENSE",
    state-name-no-sc = "ourense"
  },
  {
    state-name = "PALENCIA",
    state-name-no-sc = "palencia"
  },
  {
    state-name = "PONTEVEDRA",
    state-name-no-sc = "pontevedra"
  },
  {
    state-name = "SALAMANCA",
    state-name-no-sc = "salamanca"
  },
  {
    state-name = "SEGOVIA",
    state-name-no-sc = "segovia"
  },
  {
    state-name = "SEVILLA",
    state-name-no-sc = "sevilla"
  },
  {
    state-name = "SORIA",
    state-name-no-sc = "soria"
  },
  {
    state-name = "SANTA CRUZ DE TENERIFE",
    state-name-no-sc = "santa_cruz_de_tenerife"
  },
  {
    state-name = "TARRAGONA",
    state-name-no-sc = "tarragona"
  },
  {
    state-name = "TERUEL",
    state-name-no-sc = "teruel"
  },
  {
    state-name = "TOLEDO",
    state-name-no-sc = "toledo"
  },
  {
    state-name = "VALENCIA",
    state-name-no-sc = "valencia"
  },
  {
    state-name = "VALLADOLID",
    state-name-no-sc = "valladolid"
  },
  {
    state-name = "ZAMORA",
    state-name-no-sc = "zamora"
  },
  {
    state-name = "ZARAGOZA",
    state-name-no-sc = "zaragoza"
  }
]

// -- TOP 10 --

top-10-values = {
  order = [
    "highest",
    "lowest"
  ],
  temporal = [
    {
      value = "2024",
      title = "Year 2024"
    },
    {
      value = "decade",
      title = "in the last decade"
    },
    {
      value = "global",
      title = "from the start of registries"
    },
  ]
}

top-10 = {
  uri = ${bar-chart},
  body = {
    src = {
      path = ${top-10.data-src},
      axis = {
        x = {
          name = ${column-names.top}
        },
        y = {
          name = ${column-names.col-grouped}
        }
      }
    },
    dest = {
      path = ${top-10.data-dest},
      filename = "plot",
      export-png = true
    },
    style = {
      lettering = {
        // Params:
        // 1 - Order (highest/lowest)
        // 2 - Meteo param
        title = "Top 10 stations with %s %s",

        // Params:
        // 1 - temporal title (year 2024/last decade/from the start of registries)
        subtitle = "%s",
        x-label = "Top",

        // Params:
        // 1 - Meteo param
        // 2 - Units
        y-label = "%s (%s)",
        inside-info = [
          {
            label = "Station",
            build = [
              {
                text-before = "",
                name = ${stations-df.station-id},
                text-after = " "
              },
              {
                text-before = "",
                name = ${stations-df.station-name},
                text-after = " "
              },
              {
                text-before = "(",
                name = ${stations-df.state},
                text-after = ")."
              }
            ]
          },
          {
            label = "Location",
            build = [
              {
                text-before = "",
                name = ${stations-df.lat-dms},
                text-after = " "
              },
              {
                text-before = "",
                name = ${stations-df.long-dms},
                text-after = " "
              },
              {
                text-before = "(",
                name = ${stations-df.altitude},
                text-after = " m)."
              }
            ]
          }
        ]
      },
      figure = {
        inverted-horizontal-axis = false,
        threshold-limit-max-min = 0.5,
        threshold-perc-limit-outside-text = 0.3,
        range-margin-perc = 0.05,
        color = "#4169e1"
      },
      margin = {
        left = 120,
        right = 120,
        top = 100,
        bottom = 100
      }
    }
  }
}

// -- TOP 5 INC --

top-5-inc-values = {
  order = [
    "highest",
    "lowest"
  ]
}

top-5-inc = {
  uri = ${bar-chart},
  body = {
    src = {
      path = ${top-5-inc.data-src},
      axis = {
        x = {
          name = ${column-names.top}
        },
        y = {
          name = ${column-names.inc}
        }
      }
    },
    dest = {
      path = ${top-5-inc.data-dest},
      filename = "plot",
      export-png = true
    },
    style = {
      lettering = {
        // Params:
        // 1 - Order (highest/lowest)
        // 2 - Meteo param
        title = "Top 5 stations with %s %s increment",
        subtitle = "From the start of registries",
        x-label = "Top",

        // Params:
        // 1 - Meteo param
        // 2 - Units
        y-label = "%s increment (%s)",
        inside-info = [
          {
            label = "Station",
            build = [
              {
                text-before = "",
                name = ${stations-df.station-id},
                text-after = " "
              },
              {
                text-before = "",
                name = ${stations-df.station-name},
                text-after = " "
              },
              {
                text-before = "(",
                name = ${stations-df.state},
                text-after = ")."
              }
            ]
          },
          {
            label = "Location",
            build = [
              {
                text-before = "",
                name = ${stations-df.lat-dms},
                text-after = " "
              },
              {
                text-before = "",
                name = ${stations-df.long-dms},
                text-after = " "
              },
              {
                text-before = "(",
                name = ${stations-df.altitude},
                text-after = " m)."
              }
            ]
          }
        ]
      },
      figure = {
        inverted-horizontal-axis = false,
        threshold-limit-max-min = 0.5,
        threshold-perc-limit-outside-text = 0.3,
        range-margin-perc = 0.05,
        color = "#4169e1"
      },
      margin = {
        left = 120,
        right = 120,
        top = 100,
        bottom = 100
      }
    }
  }
}

// -- EVOL 2024 --

evol-2024 = {
  uri = ${linear-chart},
  body = {
    src = {
      path = ${evol.evol-2024.data-src},
      axis = {
        x = {
          name = ${column-names.date},
          format = ${formatters.timestamp}
        },
        y = {
          name = ${column-names.col-daily-grouped}
        }
      }
    },
    dest = {
      path = ${evol.evol-2024.data-dest},
      filename = "plot",
      export-png = true
    },
    style = {
      lettering = {
        // Params:
        // 1 - Station name
        // 2 - Station ID
        // 3 - State
        // 4 - Meteo Param
        title = "%s - %s (%s) %s evolution (2024)",

        // Params:
        // 1 - Latitude coordinate
        // 2 - Longitude coordinate
        // 3 - Altitude
        subtitle = "Lat: %s. Long: %s. Alt: %s",
        x-label = "Date",

        // Params:
        // 1 - Meteo param
        // 2 - Units
        y-label = "%s (%s)"
      },
      figure = {
        // Params:
        // 1 - Meteo param
        name = "%s evolution"
        color = "#4169e1"
      },
      margin = {
        left = 80,
        right = 80,
        top = 80,
        bottom = 80
      },
      legend = {
        y-offset = -0.3
      }
    }
  }
}

// -- EVOL YEARLY GROUP --

evol-yearly-group = {
  uri = ${linear-regression-chart},
  body = {
    src = {
      main = {
        path = ${evol.evol-yearly-group.data-src},
        axis = {
          x = {
            name = ${column-names.year},
            format = ${formatters.timestamp-year}
          },
          y = {
            name = ${column-names.col-yearly-grouped}
          }
        }
      },
      regression = {
        path = ${evol.evol-yearly-group.regression-src},
        names = {
          slope = "beta_1",
          intercept = "beta_0"
        }
      }
    },
    dest = {
      path = ${evol.evol-yearly-group.data-dest},
      filename = "plot",
      export-png = true
    },
    style = {
      lettering = {
        // Params:
        // 1 - Station name
        // 2 - Station ID
        // 3 - State
        // 4 - Meteo Param
        title = "%s - %s (%s) %s evolution (from the start of registers)",

        // Params:
        // 1 - Latitude coordinate
        // 2 - Longitude coordinate
        // 3 - Altitude
        subtitle = "Lat: %s. Long: %s. Alt: %s",
        x-label = "Date",

        // Params:
        // 1 - Meteo param
        // 2 - Units
        y-1-label = "%s (%s)"

        // Params:
        // 1 - Meteo param
        // 2 - Units
        y-2-label = "%s (%s)"
      },
      figure-1 = {
        // Params:
        // 1 - Meteo param
        name = "%s evolution"
        color = "#4169e1"
      },
      figure-2 = {
        // Params:
        // 1 - Meteo param
        name = "%s regression"
        color = "#ff0000"
      },
      margin = {
        left = 120,
        right = 120,
        top = 100,
        bottom = 100
      },
      legend = {
        y-offset = -0.15
      }
    }
  }
}

heat-map-2024-values = ["continental", "canary_islands"]

// -- HEAT MAP 2024 --
heat-map-2024 = {
  uri = ${heat-map-chart},
  body = {
    src = {
      path = ${heat-map-2024.data-src},
      names = {
        longitude = ${stations-df.long-dec},
        latitude = ${stations-df.lat-dec},
        value = ${column-names.col-grouped}
      },

      // Params:
      // 1 - Location (continental/canary_islands)
      location = "%s",
    },
    dest = {
      path = ${heat-map-2024.data-dest},
      filename = "plot",
      export-png = true
    },
    style = {
      lettering = {
        // Params:
        // 1 - Meteo Param
        title = "%s heat map",

        // Params:
        // 1 - Location (continental/canary islands)
        subtitle = "Spain %s territory. 2024",
        long-label = "Longitude",
        lat-label = "Latitude",

        // Params:
        // 1 - Meteo param
        // 2 - Units
        leyend-label = "%s (%s)"
        point-info = [
          {
            label = "Station",
            build = [
              {
                text-before = "",
                name = ${stations-df.station-id},
                text-after = " "
              },
              {
                text-before = "",
                name = ${stations-df.station-name},
                text-after = " "
              },
              {
                text-before = "(",
                name = ${stations-df.state},
                text-after = ")."
              }
            ]
          },
          {
            label = "Location",
            build = [
              {
                text-before = "",
                name = ${stations-df.lat-dms},
                text-after = " "
              },
              {
                text-before = "",
                name = ${stations-df.long-dms},
                text-after = " "
              },
              {
                text-before = "(",
                name = ${stations-df.altitude},
                text-after = " m)."
              }
            ]
          }
        ]
      },
      figure = {
        // Params:
        // 1 - Meteo param
        name = "%s heat map"
        color = "#000000",
        color-opacity = 0.5
        point-size = 3
      },
      margin = {
        left = 120,
        right = 120,
        top = 100,
        bottom = 100
      }
    }
  }
}